<% me = current_account.user %>

<% newTasksForMe       = me.get_new_tasks_assign_to_me  (@other_user) %>
<% openTasksForMe 	   = me.get_open_tasks_assign_to_me (@other_user) %>
<% completedTasksForMe = me.get_completed_tasks_assign_to_me (@other_user)  %>
			
<% myTotalNumberOfTasks = newTasksForMe.size + openTasksForMe.size + completedTasksForMe.size %>
			

<% newTasksForOther       = me.get_new_tasks_i_assigned  (@other_user) %>
<% openTasksForOther 	  = me.get_open_tasks_i_assign  (@other_user) %>
<% completedTasksForOther = me.get_completed_tasks_i_assign (@other_user)  %>
				
<% totalTasksIAssigned = newTasksForOther.size + openTasksForOther.size + completedTasksForOther.size %>
				
		

<div class="activities">
	<!-- Top Activities Panel -->
	<div class="act-main" id="activity-header">
		<input type="hidden" activityid="<%= 1 %>">
		
		<div class="avatar">
			<!-- <img class="avatar" src="images/act_avatar.gif" alt="Don-profile"> -->
			<!--%= render :partial => 'profile_images/profile_image', :collection =>  [activitydetails.get_owner], :as => :user, :class => "avatar" %-->
			<%= profile_image(@other_user)%>
		  
			
		</div>
		<div class="info">
			
			<!-- Activity Name -->

			<h1><%= @other_user.get_name %> </h1>
			
			<p><small><b>You have <%= newTasksForMe.size + openTasksForMe.size + newTasksForOther.size + openTasksForOther.size %> open tasks between you and are jointly working on 20 Activities </b> </small></p>
			
			<p class="progress-complete">
				<span>
	        </p>                                        
    		</br>  
 	  	
		</div>
		</div>
		
		
	</div>
	

	<div class="body">
		
		<div class="leftCol">
			
			<div class="clear"></div>
			
			<!-- Tasks Assign to me by other user-->
			
			<% if (myTotalNumberOfTasks > 0) %>
				<div class="tivits main-tivit" id="alltivits">
					<h2>tasks <b><%=@other_user.get_name %></b> assigned to me <span>(<%= newTasksForMe.size + openTasksForMe.size %>)</span></h2>
					<div class="tvit-list" id="mytivits">						
						
						<% if newTasksForMe.size > 0 %>
						<ul class="list">
							<%= render :partial => 'shared/task_db', :collection =>  newTasksForMe, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
						</ul>
						<% end %>
						<% if openTasksForMe.size > 0 %>
							<ul class="list">
							<%= render :partial => 'shared/task_db', :collection =>  openTasksForMe, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
							</ul>
						<% end %>
						<% if completedTasksForMe.size > 0 %>
							<ul class="list additional-tivits hide"">
								<%= render :partial => 'shared/task_db', :collection =>  completedTasksForMe, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
							</ul>
							<p class="show-other-tasks">Show <%= completedTasksForMe.size %> completed tasks</p>
						<% end %>						
					</div>
					
			<%else%>
				<div class="tivits main-tivit" id="alltivits" style="background:none" >
				
			<%end%>
				
				
			<!-- End of Main Tivits -->
			</div> <!-- My tivits -->
			
			<!-- tasks i assign to other_user -->
			
				<!-- <h2>team tivits<span>(4)</span></h2> -->
				
			
				<% if (totalTasksIAssigned > 0) %>
				
				<div class="team tivits" id="team-tivits">
					<h2>You have <span><%= openTasksForOther.size + completedTasksForOther.size %></span> open tasks you assigned to <b><%=@other_user.get_name %></b> </h2>
					<div class="tvit-list" id="teamtivits">
					
						
						<% if newTasksForOther.size > 0 %>
						<ul class="list">
							<%= render :partial => 'shared/task_db', :collection =>  newTasksForOther, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
						</ul>
						<% end %>
						<% if openTasksForOther.size > 0 %>
							<ul class="list">
							<%= render :partial => 'shared/task_db', :collection =>  openTasksForOther, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
							</ul>
						<% end %>
						<% if completedTasksForOther.size > 0 %>
							<ul class="list additional-tivits hide"">
								<%= render :partial => 'shared/task_db', :collection =>  completedTasksForOther, :as => :my_task, :locals => {:taskContext => 'ADP'} %>
							</ul>
							<p class="show-other-tasks">Show <%= completedTasksForOther.size %> completed tasks</p>
						<% end %>		
						
						
						
					</div>
				
				<% else %>
					<div class="team tivits" id="team-tivits" style="background:none">
				<%end%>
				
			</div> <!-- team tivits --> 
				
		</div> <!-- "leftCol" -->
	
	</div> <!-- "body" -->
	
</div> <!--"activities" --> 
